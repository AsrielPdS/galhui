import { div, E, g, wrap } from "galho";
import { $, body, close, doc, icon } from "./galhui.js";
import { call, extend, isA, isU, l, lazy, t } from "galho/util.js";
import { orray } from "galho/orray.js";
export function defineSize(items, apply) {
    let size = 0, l = items.length, sizes = [];
    for (let i of items) {
        let s = i.sz;
        if ((s || (s = 0)) > 95)
            s = 95;
        else if (s === 0)
            s = 100 / l;
        sizes.push(s);
        size += s;
    }
    let result = sizes.map(s => s * 100 / size);
    if (apply)
        for (let i = 0; i < l; i++)
            items[i].sz = result[i];
    return result;
}
export class Ctx extends E {
    root;
    constructor(i, root) {
        super(i);
        this.root = this.item(root);
        i.left && (i.left = orray(i.left));
        i.right && (i.right = orray(i.right));
        i.bottom && (i.bottom = orray(i.bottom));
    }
    ignoreChange;
    view() {
        let { left, right, bottom } = this.i;
        return div("_ galy", [
            left && div("l"),
            this.root,
            right && div("r"),
            bottom && div("b"),
        ]);
    }
    change() {
        if (!this.ignoreChange) {
            if (t(this.i.compress)) {
                this.ignoreChange = true;
                this.root.compress();
                this.ignoreChange = false;
            }
            this.emit("change");
        }
    }
    prots(key) {
        let t = this.i.boxes[key];
        if (!t)
            throw `protyupe "${key}" not found`;
        return t;
    }
    item(item) {
        switch (item.tp) {
            case "s" /* stack */:
                return new Stack(this, item);
            case "t" /* tab */:
                return new Tab(this, item);
            case "i" /* box */:
                return new Box(this, item.base ? extend(item, this.prots(item.base)) : item);
        }
    }
}
class Stack {
    ctx;
    i;
    constructor(ctx, i) {
        this.ctx = ctx;
        this.i = i;
        i.$ = this;
    }
    render() {
        let { list, o } = this.i, ctx = this.ctx;
        return orray(list, v => isA(v) ? v : [100 / l(list), v]).bind(div(["_", "stack", o]), {
            insert([sz, item], index, s) {
                s.place(index && index * 2 - 1, [
                    //dupla negação para não inserir 0
                    !!index && divisor("h", (l, r) => {
                        this[index - 1][0] = l;
                        this[index][0] = r;
                        ctx.change();
                    }),
                    g(ctx.item(item)).css(o == "h" ? "width" : "height", `${sz}%`)
                ]);
            },
            remove: (_, index, parent) => {
                if (index)
                    parent.childs(index * 2 - 1, index * 2 + 1).remove();
                else
                    parent.childs(0, 2).remove();
            }
        });
    }
    compress() {
        let { list, persist: p } = this.i, _l = l(list);
        if (!_l) {
            if (!p)
                return null;
        }
        else if (_l == 1)
            return list[0][1];
        else
            for (let i = 0; i < _l; i++) {
                let t0 = list[i], t = t0[1].$.compress();
                switch (t) {
                    case null:
                        //TODO: remove from context
                        list.removeAt(i--);
                        break;
                    case undefined:
                        break;
                    default:
                        throw "not implemented";
                    // replace(t0, [t0[0], <iitems>t]);
                }
            }
    }
}
class Tab {
    i;
    constructor(ctx, i) {
        this.i = i;
        i.$ = this;
    }
    render() {
        let i = this.i, list = i.list;
        return div("_ tab", [
            list.bind(div("hd" /* head */), {
                tag: (v, i, p) => p.child(i).c("on", v),
                insert: box => box.$.head().c("i" /* item */)
                    .add(close(e => { e.stopPropagation(); list.remove(box); }))
                    .on('click', () => list.tag("on", box))
            }),
            call(div("bd" /* body */), b => {
                let cb = (v) => {
                    b.attr("id", false).c("bd" /* body */);
                    if (v) {
                        b.set(v.$.render(true));
                        //v.$.focus?.(b);
                    }
                    else
                        b.set(i.empty?.());
                };
                list.ontag("on", cb);
                cb(list.tags?.on.v);
            }),
        ]);
    }
    compress() {
        let { list, persist: p } = this.i;
        if (!list) {
            if (!p)
                return null;
        }
        else if (l(list) == 1)
            if (l[0].selfContain)
                return l[0];
    }
}
class Box {
    i;
    constructor(ctx, i) {
        this.i = i;
        if (i.def && isU(i.dt))
            i.dt = i.def();
        i.$ = this;
    }
    render(headerless) {
        let bd = wrap(this.i.render());
        return headerless ? bd.c("i" /* item */) : div("_ tab", [
            this.head().c("_ bar"),
            div("bd" /* body */, bd)
        ]);
    }
    head() {
        let i = this.i;
        return div(0, [
            icon(i.icon),
            lazy(i.title),
            close(() => { })
        ]);
    }
    compress() { }
}
/**box interface */
export const ibox = (base) => ({ tp: "i" /* box */, base });
/**row interface */
export const irow = (...list) => ({ tp: "s" /* stack */, o: "h", list });
/**col interface */
export const icol = (...list) => ({ tp: "s" /* stack */, o: "v", list });
/**tab interface */
export const itab = (...list) => ({ tp: "t" /* tab */, list });
export function divisor(o, endcallback) {
    let hr = g('hr', "l-d" /* divisor */);
    return hr.on('mousedown', function () {
        let parent = hr.parent(), parentRect = parent.rect(), prev = hr.prev(), next = hr.next(), l, r, div = $.lyDivW / 2, clamp = (value, min, max) => value < min ? min : value > max ? max : value, trigger = () => {
            let e = new Event("resize", { bubbles: true });
            prev.emit(e);
            next.emit(e);
        };
        function moveEventX(e) {
            let p = parentRect.width * 0.05;
            l = clamp(e.clientX - parentRect.left, p, parentRect.left - p);
            prev.css('width', `calc(${(l = l / parentRect.width * 100)}% - ${div}px)`);
            next.css('width', `calc(${(r = 100 - l)}% - ${div}px)`);
            trigger();
        }
        function moveEventY(e) {
            let p = parentRect.height * 0.05;
            l = clamp(e.clientX - parentRect.top, p, parentRect.top - p);
            prev.css('height', `calc(${(l = l / parentRect.height * 100)}% - ${div}px)`);
            next.css('height', `calc(${(r = 100 - l)}% - ${div}px)`);
            trigger();
        }
        body.css({ cursor: 'col-resize', userSelect: "none" });
        let t = o == "h" ? moveEventX : moveEventY;
        doc
            .on('mousemove', t)
            .one('mouseup', () => {
            body.uncss(["cursor", "userSelect"]);
            doc.off('mousemove', t);
            endcallback?.(l, r);
        });
    });
}
export const stack = (o, list) => div(["_", "stack", o], list.map((v, i) => {
    let [sz, item] = isA(v) ? v : [100 / l(list), v];
    return [
        !!i && divisor("h"),
        g(item).css(o == "h" ? "width" : "height", `${sz}%`)
    ];
}));
export const row = (...list) => stack("h", list);
export const col = (...list) => stack("v", list);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGF5b3V0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibGF5b3V0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBZSxJQUFJLEVBQUUsTUFBTSxPQUFPLENBQUM7QUFDckQsT0FBTyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUssS0FBSyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQVEsTUFBTSxhQUFhLENBQUM7QUFDakUsT0FBTyxFQUFRLElBQUksRUFBRSxNQUFNLEVBQWMsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLEVBQUUsSUFBSSxFQUFPLENBQUMsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMxRixPQUFPLEVBQVksS0FBSyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFxQmpELE1BQU0sVUFBVSxVQUFVLENBQUMsS0FBaUIsRUFBRSxLQUFlO0lBQzNELElBQ0UsSUFBSSxHQUFHLENBQUMsRUFDUixDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sRUFDaEIsS0FBSyxHQUFHLEVBQUUsQ0FBQztJQUNiLEtBQUssSUFBSSxDQUFDLElBQUksS0FBSyxFQUFFO1FBQ25CLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUM7UUFDYixJQUFJLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRTtZQUNyQixDQUFDLEdBQUcsRUFBRSxDQUFDO2FBQ0osSUFBSSxDQUFDLEtBQUssQ0FBQztZQUNkLENBQUMsR0FBRyxHQUFHLEdBQUcsQ0FBQyxDQUFDO1FBQ2QsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNkLElBQUksSUFBSSxDQUFDLENBQUM7S0FDWDtJQUNELElBQUksTUFBTSxHQUFHLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEdBQUcsR0FBRyxHQUFHLElBQUksQ0FB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RSxVQUFVLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQztRQUN2RCxJQUFJLENBQUMsR0FBRyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQztRQUMzQyxHQUFHO2FBQ0EsRUFBRSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7YUFDbEIsR0FBRyxDQUFDLFNBQVMsRUFBRSxHQUFHLEVBQUU7WUFDbkIsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLFFBQVEsRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDO1lBQ3JDLEdBQUcsQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ3hCLFdBQVcsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztRQUN0QixDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQztBQUNELE1BQU0sQ0FBQyxNQUFNLEtBQUssR0FBRyxDQUFDLENBQU0sRUFBRSxJQUErQixFQUFFLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxHQUFHLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7SUFDekcsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQWEsQ0FBQyxHQUFHLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQzdELE9BQU87UUFDTCxDQUFDLENBQUMsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUM7UUFDbkIsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO0tBQ3JELENBQUM7QUFDSixDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ0osTUFBTSxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUMsR0FBRyxJQUErQixFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxDQUFDO0FBQzVFLE1BQU0sQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLEdBQUcsSUFBK0IsRUFBRSxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQyJ9