"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.tip = exports.ctx = exports.popup = exports.fixed = exports.fixedMenu = exports.fluid = exports.error = exports.ok = exports.yesNo = exports.okCancel = exports.headBody = exports.fromPanel = exports.addClose = exports.mapButtons = exports.closeModal = exports.openBody = exports.openModal = exports.modalBody = exports.modal = void 0;
const galho_1 = require("galho");
const m_1 = require("galho/m");
const s_1 = require("galho/s");
const inutil_1 = require("inutil");
const galhui_1 = require("./galhui");
//TODO remover valid
function modal(i = {}) {
    let resolve, p = (0, inutil_1.ex)(new Promise(r => resolve = r), i);
    p.cb = resolve;
    return p;
}
exports.modal = modal;
function modalBody(md, bd, actions, i = {}) {
    md.body = (0, galho_1.g)("form", (0, galho_1.cl)("_ modal panel", i.cls), [
        (0, galho_1.wrap)(bd, "bd"),
        (0, inutil_1.t)(i.close) && (0, galhui_1.close)(() => closeModal(md)),
        actions && (0, galho_1.div)("ft" /* foot */, actions.map(a => a.on('click', e => { e.preventDefault(); closeModal(md, a.d()); })))
    ]).on('keydown', (e) => {
        if (e.key == "Escape") {
            (0, galho_1.clearEvent)(e);
            closeModal(md);
        }
    });
    return md;
}
exports.modalBody = modalBody;
function openModal(md) {
    if (!md.area) {
        md.area = (0, galho_1.div)((0, galhui_1.hc)("mda" /* modalArea */), md.body).addTo(galhui_1.body);
        md.blur && md.area.prop("tabIndex", 0).on("focus", () => closeModal(md));
    }
    return md;
}
exports.openModal = openModal;
function openBody(md, bd, actions, i) {
    return openModal(modalBody(md, bd, actions, i));
}
exports.openBody = openBody;
async function closeModal(md, v) {
    if (md.area && (!md.valid || await md.valid(v))) {
        md.area.remove();
        md.cb(v);
        md.area = null;
    }
}
exports.closeModal = closeModal;
function mapButtons(md) {
    (0, m_1.each)(md.body.child(".ft").childs('[type="button"],[type="submit"]'), bt => bt.on("click", e => { e.preventDefault(); closeModal(md, bt.d()); }));
    return md;
}
exports.mapButtons = mapButtons;
function addClose(md) {
    md.body.add((0, galhui_1.close)(() => closeModal(md)));
    return md;
}
exports.addClose = addClose;
function fromPanel(panel, i = {}) {
    let md = modal(i);
    md.body = (0, galho_1.g)(panel, "_ modal panel");
    return openModal(mapButtons(addClose(md)));
}
exports.fromPanel = fromPanel;
const headBody = (i, title, bd) => [
    (0, galho_1.div)("hd", [(0, galhui_1.icon)(i), title]),
    (0, galho_1.wrap)(bd, "bd"),
];
exports.headBody = headBody;
function okCancel(body, valid) {
    return openBody(modal({ valid: valid && (v => !v || valid()) }), body, [(0, galhui_1.confirm)().d(true), (0, galhui_1.cancel)()]);
}
exports.okCancel = okCancel;
function yesNo(body, valid) {
    return openBody(modal({ valid: valid && (v => !v || valid()) }), body, [(0, galhui_1.positive)(null, galhui_1.w.yes).d(true), (0, galhui_1.negative)(null, galhui_1.w.no)]);
}
exports.yesNo = yesNo;
function ok(msg) {
    return openBody(modal(), msg, [(0, galhui_1.confirm)()]);
}
exports.ok = ok;
function error(msg) {
    return openBody(modal(), msg, [(0, galhui_1.confirm)()], { cls: "_e" /* error */ });
}
exports.error = error;
/**dropdown with width>=base.width  */
function fluid({ left: l, right: r, bottom: b, top: t, width: w, height: h }, menu, vAlign, hAlign, sub) {
    let wh = window.innerHeight, ww = window.innerWidth;
    if (!vAlign)
        vAlign = (t + h / 2) > (wh / 2) ? "t" /* top */ : "b" /* bottom */;
    if (!hAlign)
        hAlign = (l + w / 2) > (ww / 2) ? "l" /* left */ : "r" /* right */;
    menu.css('minWidth', w + 'px');
    if (vAlign == "t" /* top */) {
        menu
            .uncss(['top'])
            .css({
            bottom: (wh - (sub ? b : t)) + 'px',
            maxHeight: (sub ? b : t) + 'px'
        })
            .cls("b" /* bottom */, false);
    }
    else {
        menu
            .uncss(['bottom'])
            .css({
            top: (sub ? t : b) + 'px',
            maxHeight: (wh - (sub ? t : b)) + 'px'
        })
            .cls("t" /* top */, false);
    }
    if (hAlign == "l" /* left */) {
        menu
            .uncss(['left'])
            .css('right', (ww - (sub ? l : r)) + 'px')
            .cls("r" /* right */, false);
    }
    else {
        menu
            .uncss(['right'])
            .css('left', (sub ? r : l) + 'px')
            .cls("l" /* left */, false);
    }
    menu.cls([vAlign, hAlign]);
}
exports.fluid = fluid;
/**dropdown with width=base.width  */
function fixedMenu(base, menu, align) {
    base.cls(["t" /* top */, "b" /* bottom */], false).cls(fixed((0, s_1.rect)(base), menu, align));
}
exports.fixedMenu = fixedMenu;
function fixed({ left: l, bottom: b, top: t, width: w }, menu, align) {
    let wh = window.innerHeight;
    menu.css('width', w + 'px');
    if (wh / 2 - t > 0) {
        menu.css({
            left: l + 'px',
            top: b + 'px',
            maxHeight: (wh - b) + 'px'
        }).uncss(['bottom']);
        return "b" /* bottom */;
    }
    menu.css({
        left: l + 'px',
        bottom: (wh - t) + 'px',
        maxHeight: t + 'px'
    }).uncss(['top']);
    return "t" /* top */;
}
exports.fixed = fixed;
function popup(div, e) {
    let last = (0, galho_1.active)(), ctx = div.prop("tabIndex", 0), 
    // isOut: bool,
    wheelHandler = (e) => (0, galho_1.clearEvent)(e);
    ctx.queryAll('button').on('click', function () { last.valid ? last.focus() : this.blur(); });
    ctx.on({
        focusout: (e) => (0, s_1.contains)(ctx, e.relatedTarget) || (ctx.remove() && galhui_1.body.off("wheel", wheelHandler)),
        keydown(e) {
            if (e.key == "Escape") {
                e.stopPropagation();
                ctx.blur();
            }
        }
    }).addTo(galhui_1.body).focus();
    // .css({
    //   left: opts.clientX + 'px',
    //   top: opts.clientY + 'px'
    // })
    requestAnimationFrame(function _() {
        fluid(e(), ctx);
        if (galhui_1.body.contains(ctx))
            requestAnimationFrame(_);
    });
    galhui_1.body.on("wheel", wheelHandler, { passive: false });
}
exports.popup = popup;
/**context menu */
function ctx(e, data) {
    (0, galho_1.clearEvent)(e);
    popup((0, galho_1.div)("_ menu", (0, galho_1.g)("table", 0, data)), () => new DOMRect(e.clientX, e.clientY, 0, 0));
}
exports.ctx = ctx;
function tip(root, div, vAlign, hAlign) {
    div = (0, galho_1.wrap)(div).cls("_ tip");
    return root.on({
        mouseenter() {
            galhui_1.body.add(div);
            requestAnimationFrame(function _() {
                fluid((0, s_1.rect)(root), div, vAlign, hAlign);
                if (galhui_1.body.contains(div))
                    requestAnimationFrame(_);
            });
        },
        mouseleave() { div.remove(); }
    });
}
exports.tip = tip;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaG92ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJob3Zlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxpQ0FBcUU7QUFDckUsK0JBQStCO0FBQy9CLCtCQUF5QztBQUN6QyxtQ0FBK0I7QUFDL0IscUNBQW9JO0FBb0JwSSxvQkFBb0I7QUFDcEIsU0FBZ0IsS0FBSyxDQUFVLElBQWUsRUFBRTtJQUM5QyxJQUFJLE9BQVksRUFBRSxDQUFDLEdBQUcsSUFBQSxXQUFFLEVBQUMsSUFBSSxPQUFPLENBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEdBQUcsQ0FBQyxDQUFhLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDMUUsQ0FBQyxDQUFDLEVBQUUsR0FBRyxPQUFPLENBQUM7SUFDZixPQUFPLENBQUMsQ0FBQztBQUNYLENBQUM7QUFKRCxzQkFJQztBQUNELFNBQWdCLFNBQVMsQ0FBSSxFQUFZLEVBQUUsRUFBTyxFQUFFLE9BQWEsRUFBRSxJQUFXLEVBQUU7SUFDOUUsRUFBRSxDQUFDLElBQUksR0FBRyxJQUFBLFNBQUMsRUFBQyxNQUFNLEVBQUUsSUFBQSxVQUFFLEVBQUMsZUFBZSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRTtRQUM5QyxJQUFBLFlBQUksRUFBQyxFQUFFLEVBQUUsSUFBSSxDQUFDO1FBQ2QsSUFBQSxVQUFDLEVBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLElBQUEsY0FBTyxFQUFDLEdBQUcsRUFBRSxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMzQyxPQUFPLElBQUksSUFBQSxXQUFHLG1CQUFTLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxD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